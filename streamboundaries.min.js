(function(e,t,n,r){function o(t,n){var i=t.target.id==="sb_cross"?e(t.target).parent():e(t.target),s=i.offset();return{x:t.pageX-r.round(s.left)+n.left,y:t.pageY-r.round(s.top)+n.top}}function u(e){var t=e.attr("data-streamboundariesid");return t?i[t]:e}var i={},s={init:function(s){function f(e,t){var n=u.s.thumb,i=r.round(e.height),s=r.round(t.height),o=r.round(e.width),a=r.round(t.width);if(s>i&&u.s.orientation==="x"){n.css({top:-(s-i)/2})}if(a>o&&u.s.orientation==="y"){n.css({left:-(a-o)/2})}if(u.s.bounds===!1||u.autobounds){u.autobounds=!0;u.s.bounds={bottom:i-s,left:0,top:0,right:o-a}}}var u=this;if(!u.length||u.attr("data-streamboundariesid")){return u}if(u.length>1){u.each(function(){e.fn.streamBoundaries(s)});return u}var a=function(){};u.s=e.extend({aspectRatio:!1,autoRotate:!0,bg:"#DEDEDE",centerThumb:!0,crosshair:!0,bounds:!1,height:"5px",isViewport:!1,lockAspectRatio:!1,minResizeHeight:"20px",minResizeWidth:"20px",onBeforeUpdate:a,onFinish:a,onUpdate:a,orientation:"x",resizable:!1,round:!0,scale9Grid:!1,scaleX:!0,scaleY:!0,thumb:u.find("*:first"),thumbBg:"#333",thumbBorder:"solid thin #005400",thumbBorderRadius:0,thumbHeight:"5px",thumbWidth:"10%",trackBorderRadius:0,width:"300px",x:!1,y:!1},s);u.offsetX=0;u.offsetY=0;u.autobounds=!1;u.c=++n;u.isresize;u.attr({"data-streamboundariesid":u.c});u.render=function(t,n){var r=u.s,i=r.thumb,s=r.orientation==="y"&&r.autoRotate,o={width:r[s?"height":"width"],height:r[s?"width":"height"],background:r.bg,"border-radius":r.trackBorderRadius,position:"relative"},a={width:r["thumb"+(s?"Height":"Width")],height:r["thumb"+(s?"Width":"Height")],background:r.thumbBg,"border-radius":r.thumbBorderRadius,position:"relative","box-sizing":"border-box",cursor:"pointer",border:r.thumbBorder};if(r.resizable&&!e(".sb_thumbres",u).length){var l="<style>.sb_thumbres {max-width:30px;max-height:30px;position:absolute;width:20%;"+"height:20%;}.sb_scale9 {position:absolute;background:#005400;}"+".sb_scale9H{height:100%;width:1px;} .sb_scale9V {width: 100%;height:1px;}</style>"+('<div id="sbtTM" class="sb_thumbres" style="cursor:n-resize;'+'border-top:solid 2px #000;left:50%;top:-1px;margin-left: -15px;"></div>')+('<div id="sbtRM" class="sb_thumbres" style="cursor:e-resize;'+'border-right:solid 2px #000;right:-1px;top:50%;margin-top: -15px;"></div>')+('<div id="sbtB" class="sb_thumbres" style="width:20%;height:20%;cursor:se-resize;'+"border-right:solid 2px #000;border-bottom:solid 2px #000;max-width:30px;"+'max-height:30px;right:-1px;bottom:-1px;"></div>')+('<div id="sbtBM" class="sb_thumbres" style="cursor:s-resize;'+'border-bottom:solid 2px #000;left:50%;bottom:-1px;margin-left: -15px;"></div>')+('<div id="sbtL" class="sb_thumbres" style="cursor:sw-resize;'+'border-left:solid 2px #000;border-bottom:solid 2px #000;left:-1px;bottom:-1px;"></div>')+('<div id="sbtLM" class="sb_thumbres" style="cursor:w-resize;'+'border-left:solid 2px #000;left:-1px;top:50%;margin-top: -15px;"></div>');if(u.s.scale9Grid){l+='<div class="sb_scale9 sb_scale9H" style="left:33%;"></div>'+'<div class="sb_scale9 sb_scale9H" style="left:66%;"></div>'+'<div class="sb_scale9 sb_scale9V" style="top:33%;"></div>'+'<div class="sb_scale9 sb_scale9V" style="top:66%;"></div>'}i.append(l)}if(r.crosshair&&!e("#sb_cross",u).length){i.append('<div id="sb_cross" style="font-size: 20px;position: absolute;top: 50%;left: 50%;width: 20px;'+"height: 20px;overflow: hidden;margin: -10px 0 0 -10px;text-align: center; line-height: 20px;"+'border-radius: 20px;background: #FFF;opacity: 0.5;">+</div>')}if(t||t===0||r.x||r.x===0){a["left"]=t||t===0?t:r.x}if(n||n===0||r.y||r.y===0){a["top"]=n||n===0?n:r.y}if(u.s.isViewport){o["overflow"]="hidden"}u.css(o);i.css(a);var c=i[0].getBoundingClientRect(),h=u[0].getBoundingClientRect();f(h,c);var p=c.left-h.left,d=c.top-h.top;u.positionData={bounds:r.bounds,jqueryEvent:null,lastMove:null,originalEvent:null,px:p/(r.bounds.right-r.bounds.left),py:d/(r.bounds.bottom-r.bounds.top),thumbRatio:c.width/c.height,trackHeight:h.height,trackWidth:h.width,type:null,x:p,x2:p+c.width,y:d,y2:d+c.height}};u.render();u.recalculatePositionData=function(e,t,n,i,s){n=n===undefined?null:n;i=i===undefined?null:i;s=s===undefined?null:s;var o=u.s.thumb,a=o[0].getBoundingClientRect(),f=u.isresize,l=u.rect?u.rect:u[0].getBoundingClientRect(),c=f?a.left-l.left:e,h=f?a.top-l.top:t,p=a.width,d=a.height,v=l.width,m=l.height,g=u.s.bounds,y=g.bottom,b=g.left,w=g.top,E=g.right;if(u.s.round){c=r.round(c);h=r.round(h);p=r.round(p);d=r.round(d);v=r.round(v);m=r.round(m)}u.positionData={bounds:u.s.bounds,jqueryEvent:i,originalEvent:s,px:c/(E-b),py:h/(y-w),lastMove:n,thumbRatio:p/d,thumbHeight:d,thumbWidth:p,trackHeight:m,trackWidth:v,x:c,x2:c+p,y:h,y2:h+d}};u.posLT=function(){var e=u.s,t=e.centerThumb,n=e.thumb,r=u[0].getBoundingClientRect(),i=n[0].getBoundingClientRect(),s=e.orientation,o=!1,a=!1,f=(e.width-i.width)/2,l=(e.height-i.height)/2,c=u.positionData.x,h=u.positionData.y;if(s==="x"||s==="2d"){if(i.left>=r.left){o=0}else if(i.right<=r.right){o=e.width-i.width}if(o!==!1){c=t&&f>0?f:o;n.css({left:c})}}if(s==="y"||s==="2d"){if(i.top>=r.top){a=0}else if(i.bottom<=r.bottom){a=e.height-i.height}if(a!==!1){h=t&&l>0?l:a;n.css({top:h})}}u.recalculatePositionData(c,h)};u.wmm=function(e){e.preventDefault();if(u.s.onUpdate.call(u,u.positionData)===false){return}var t=e.clientX-u.offsetX,n=e.clientY-u.offsetY,i=0,s=0,o=u.s,a=o.orientation,f=a==="2d",l=a==="y",c=a==="x",h=o.thumb,p=o.bounds,d=p.bottom,v=p.left,m=p.top,g=p.right,y="normal",b=o.round;if(o.isViewport){y="viewport";i=t;s=n;if(c||f){h.css({left:i})}if(l||f){h.css({top:s})}}else if(u.isresize){y="resize";var w=u.thumbRect,E=u.rect,S=o.aspectRatio||w.width/w.height,x=u.curTarget.id,N=x==="sbtLM"||x==="sbtL"||x==="sbtT",C=u.curTarget.id==="sbtTM"||u.curTarget.id==="sbtT"||u.curTarget.id==="sbtR";i=w.right-E.left;s=w.bottom-E.top;if(x==="sbtRM"||x==="sbtLM"){c=!0;l=f=!1}if(x==="sbtTM"||x==="sbtBM"){l=!0;c=f=!1}if((c||f)&&o.scaleX){var k=i+t-(w.left-E.left),L={};if(N){var A=w.left-E.left,O=A+(k-w.width);i=L.left=O;L.right=w.right;k=w.width-(k-w.width);if(O<=o.bounds.left){i=L.left=o.bounds.left;k=A+w.width}else if(k<=parseFloat(o.minResizeWidth)){i=L.left=w.right-o.minResizeWidth;k=o.minResizeWidth}}else{if(k+w.left>=E.right){k=E.width-(w.left-E.left)}else if(k<=parseFloat(o.minResizeWidth)){k=o.minResizeWidth}}if(e.shiftKey&&f||o.lockAspectRatio){if(k/S+(w.top-E.top)>E.height){k=(E.height-(w.top-E.top))*S}}L.width=b?r.round(k):k;h.css(L)}if((l||f)&&o.scaleY){var M=s+n-(w.top-E.top),_={};if(e.shiftKey&&f||o.lockAspectRatio){M=k/S}if(C){var D=w.top-E.top,P=D+(M-w.height);s=_.top=P;_.bottom=w.bottom;M=w.height-(M-w.height);if(P<=o.bounds.top){s=_.top=o.bounds.top;M=D+w.height}else if(M<=parseFloat(o.minResizeHeight)){s=_.top=w.bottom-o.minResizeHeight;M=o.minResizeHeight}}else{if(M+w.top>=E.bottom){M=E.height-(w.top-E.top)}else if(M<=parseFloat(o.minResizeHeight)){M=o.minResizeHeight}}_.height=b?r.round(M):M;h.css(_)}}else{if(c||f){if(t<=v){i=v}else if(t>=g){i=g}else{i=t}t=b?r.round(i):i;h.css({left:i})}if(l||f){if(n<=m){s=m}else if(n>=d){s=d}else{s=n}t=b?r.round(s):s;h.css({top:s})}}u.recalculatePositionData(i,s,y,e,e.originalEvent)};u.find("div").mousedown(function(n){if(n.which===3){return}if(u.s.onBeforeUpdate.call(u,u.positionData)===false){return}n.preventDefault();u.rect=u[0].getBoundingClientRect();u.thumbRect=u.s.thumb[0].getBoundingClientRect();u.isresize=e(n.target).hasClass("sb_thumbres");f(u.rect,u.thumbRect);u.startDim={width:u.thumbRect.width,height:u.thumbRect.height};var r=e(t);if(u.isresize){u.curTarget=n.target;u.offsetX=n.clientX;u.offsetY=n.clientY}else{var i=o(n,u.rect);u.offsetX=i.x;u.offsetY=i.y}r.mousemove(u.wmm);r.one("mouseup",function(){r.unbind("mousemove",u.wmm);if(u.s.isViewport){u.posLT()}u.isresize=!1;u.s.onFinish.call(u,u.positionData)})});i[u.c]=u;return u},updateOpts:function(t){var n=this;if(t.bounds){n.autobounds=!1}n.s=e.extend(e.extend({},n.s),t);n.render();return n},reposition:function(e){var t=this;if(!e){e={}}t.render(e.x,e.y);if(t.s.isViewport){t.posLT()}return t},getPositionData:function(){return this.positionData}};e.fn.streamBoundaries=function(t){var n=u(this);if(s[t]){return s[t].apply(n,Array.prototype.slice.call(arguments,1))}else if(Object.prototype.toString.call(t)==="[object Object]"||!t){return s.init.apply(n,arguments)}else{e.error(["The method ",t," does not exist"].join(""))}};e.streamBoundaries={clearCache:function(){i=[]},unsetMouseMove:function(){for(var n in i){var r=i[n];e(t).unbind("mousemove",r.wmm)}}}})(jQuery,this,0,Math)